# 正确命令格式说明

## 问题

用户使用了错误的命令格式：
```bash
uv run main.py extract --baseline ... --prompt-version v3 --force-extract
```

**错误**：`main.py` 没有 `extract` 子命令。

## 正确的命令格式

### 仅提取检查点（不进行评估）

使用 `--extract-cache-only` 参数：

```bash
uv run main.py \
    --baseline "../srs-docs/resources/req_md_sample10/2007 - eirene fun 7.pdf.md" \
    --extract-cache-only \
    --prompt-version v3 \
    --force-extract
```

### 参数说明

- `--baseline`: 基准文档路径（必填）
- `--extract-cache-only`: 仅构建要点缓存，不进行评估
- `--prompt-version v3`: 使用v3版本的提示词（支持多维分类）
- `--force-extract`: 强制重新提取（忽略缓存）

### 其他常用参数

- `--extract-runs N`: 执行N次提取，选择检查项数量最多的结果（默认：1）
- `--max-workers N`: 并行执行时的最大工作线程数

## 完整示例

### 1. 提取单个文档的检查点

```bash
uv run main.py \
    --baseline "../srs-docs/resources/req_md_sample10/2007 - eirene fun 7.pdf.md" \
    --extract-cache-only \
    --prompt-version v3 \
    --force-extract
```

### 2. 提取目录中所有文档的检查点

```bash
uv run main.py \
    --baseline-dir "../srs-docs/resources/req_md_sample10" \
    --extract-cache-only \
    --prompt-version v3 \
    --force-extract
```

### 3. 多次提取取最优结果

```bash
uv run main.py \
    --baseline "../srs-docs/resources/req_md_sample10/2007 - eirene fun 7.pdf.md" \
    --extract-cache-only \
    --prompt-version v3 \
    --force-extract \
    --extract-runs 3
```

## 验证提取结果

提取完成后，检查缓存文件：

```bash
# 查看缓存文件
cat .cache/points/2007\ -\ eirene\ fun\ 7.pdf_*.json | head -20

# 检查是否包含Category信息
python3 -c "
import json
from pathlib import Path

cache_file = Path('.cache/points').glob('2007 - eirene fun 7.pdf_*.json')
for f in cache_file:
    with open(f, 'r') as file:
        data = json.load(file)
        checkpoints = data.get('checkpoints', [])
        if checkpoints and '\t' in checkpoints[0]:
            print('✅ 包含Category信息')
            print(f'示例: {checkpoints[0]}')
        else:
            print('❌ 仍然无Category信息')
"
```

