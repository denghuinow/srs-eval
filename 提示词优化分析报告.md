# 提示词优化分析报告

## 一、缓存文件分析

### 1.1 文件概览

分析了6个缓存文件，发现：

- **已包含Category信息的文件**（5个）：
  - `2005 - clarus low.pdf` (284个检查点)
  - `2004 - watcom gui.pdf` (221个检查点)
  - `2003 - tachonet.pdf` (54个检查点)
  - `2010 - fishing.pdf` (72个检查点)
  - `2003 - agentmom.pdf` (48个检查点)

- **未包含Category信息的文件**（1个）：
  - `2001 - telescope.pdf` (145个检查点，纯文本格式)

### 1.2 维度分布统计

从已包含Category的文件统计：

| 维度 | 典型数量 | 占比 | 说明 |
|------|---------|------|------|
| FUNCTIONAL | 最多 | 60-80% | 功能描述占主导 |
| BUSINESS_FLOW | 中等 | 15-30% | 流程步骤较多 |
| BOUNDARY | 较少 | 2-10% | 边界条件提取不足 |
| EXCEPTION | 较少 | 2-8% | 异常处理提取不足 |
| CONSISTENCY_RULE | 较少 | 2-15% | 一致性规则提取不足 |

## 二、发现的问题

### 2.1 分类不准确

**问题示例：**

1. **功能与流程混淆**
   - ❌ `"GUIXMain calls GUIStoreArgs"` 被分类为 BUSINESS_FLOW
   - ✅ 应该是 FUNCTIONAL（系统功能调用）

2. **边界条件被误分类**
   - ❌ `"The Clarus system shall be able to publish new data within twenty minutes"` 被分类为 FUNCTIONAL
   - ✅ 应该是 BOUNDARY（时间限制）

3. **异常处理被误分类**
   - ❌ `"The Clarus system shall detect out of range values"` 被分类为 EXCEPTION
   - ✅ 应该是 FUNCTIONAL（检测功能）

### 2.2 检查点粒度不一致

**问题示例：**

1. **过细的检查点**
   - `"GUIXMain calls GUIStoreArgs"`
   - `"GUIStoreArgs calls GUISetWindowClassName"`
   - 这些应该是实现细节，不是需求检查点

2. **过粗的检查点**
   - `"The ELSS must capture all data necessary for recording the fishing activities"`
   - 应该拆分为多个具体的检查点

### 2.3 重复检查点

**问题示例：**

在 `agentmom.pdf` 中：
- `"agentMom supports sending unicast messages."`
- `"agentMom supports receiving unicast messages."`
- `"agentMom supports encrypting unicast messages."`
- `"agentMom supports decrypting unicast messages."`

这些可以合并为更高级的检查点。

### 2.4 维度覆盖不均

**问题：**

- **BOUNDARY维度提取不足**：很多数值限制、时间限制被归类到FUNCTIONAL
- **EXCEPTION维度提取不足**：错误处理、异常场景描述不够
- **CONSISTENCY_RULE维度提取不足**：约束规则、互斥条件描述不够

## 三、优化措施

### 3.1 提示词优化

已对 `prompts/v3/extract_points.md` 进行以下优化：

1. **更明确的维度定义**
   - 为每个维度添加了详细的定义
   - 明确了抽取范围和排除项
   - 提供了正反示例

2. **增强的分类指导**
   - FUNCTIONAL：强调功能、能力、服务
   - BUSINESS_FLOW：强调流程、步骤、时序
   - BOUNDARY：强调数值、范围、限制
   - EXCEPTION：强调错误、异常、失败
   - CONSISTENCY_RULE：强调约束、规则、互斥

3. **添加抽取原则**
   - 原子性：一个检查点一个需求
   - 客观性：基于原文，不推断
   - 可验证性：能够验证实现
   - 去重性：避免重复
   - 完整性：确保维度覆盖
   - 精确分类：避免错误分类

### 3.2 关键改进点

1. **明确排除项**：每个维度都说明了什么不属于该维度
2. **提供示例**：正反示例帮助理解分类标准
3. **强调特征**：每个维度的关键特征帮助准确分类
4. **完整性要求**：要求确保五大维度都有检查点（如果文档包含相关内容）

## 四、建议

### 4.1 使用建议

1. **重新提取**：对于重要文档，建议使用优化后的提示词重新提取检查点
2. **人工审核**：提取后建议人工审核分类准确性
3. **维度平衡**：如果某个维度检查点过少，检查是否遗漏

### 4.2 进一步优化方向

1. **添加后处理**：可以添加去重逻辑，合并语义相似的检查点
2. **质量检查**：可以添加检查点质量评估，识别过细或过粗的检查点
3. **统计分析**：可以添加维度分布统计，帮助发现遗漏

## 五、总结

通过分析缓存文件，发现了分类不准确、粒度不一致、重复检查点、维度覆盖不均等问题。

已通过优化提示词，提供更明确的维度定义、分类指导和抽取原则，预期能够：

- ✅ 提高分类准确性
- ✅ 改善检查点粒度一致性
- ✅ 减少重复检查点
- ✅ 改善维度覆盖平衡

建议在使用优化后的提示词时，结合人工审核，确保检查点质量。

