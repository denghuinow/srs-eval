# 语法错误修复说明

## 问题描述

运行提取命令时出现语法错误：
```
SyntaxError: unmatched ']'
File "/root/project/srs/srs-eval/src/point_extractor.py", line 790
```

## 根本原因

使用了Python 3.10+的联合类型语法 `|`，但在某些嵌套情况下可能导致解析错误。为了更好的兼容性和可读性，统一改用 `Optional` 和 `Union`。

## 修复内容

### 1. 导入类型工具
```python
from typing import Any, Optional, Union
```

### 2. 修复的类型注解

**修复前**：
```python
def _extract_points_single(
    self, content: str, document_path: str | Path | None = None
) -> tuple[list[str], list[tuple[str, str]] | None]:
```

**修复后**：
```python
def _extract_points_single(
    self, content: str, document_path: Optional[Union[str, Path]] = None
) -> tuple[list[str], Optional[list[tuple[str, str]]]]:
```

### 3. 修复的文件

- ✅ `src/point_extractor.py` - 所有类型注解已修复
- ✅ `src/evaluator.py` - 所有类型注解已修复

### 4. 修复的类型模式

| 修复前 | 修复后 |
|--------|--------|
| `str \| Path \| None` | `Optional[Union[str, Path]]` |
| `list[str] \| None` | `Optional[list[str]]` |
| `dict[int, str] \| None` | `Optional[dict[int, str]]` |
| `float \| None` | `Optional[float]` |
| `MergeStrategy \| str` | `Union[MergeStrategy, str]` |

## 验证

✅ 语法检查通过：
```bash
python3 -m py_compile src/point_extractor.py src/evaluator.py
```

## 下一步

现在可以重新运行提取命令：
```bash
uv run main.py extract \
    --baseline "../srs-docs/resources/req_md_sample10/2007 - eirene fun 7.pdf.md" \
    --prompt-version v3 \
    --force-extract
```

修复后的代码应该能够：
1. ✅ 正确提取带Category的检查点
2. ✅ 保存为"Category\tCheckpoint"格式到缓存
3. ✅ 评估时正确解析Category信息

